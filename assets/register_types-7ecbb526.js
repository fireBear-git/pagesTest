var It=Object.defineProperty;var Lt=(r,e,s)=>e in r?It(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var I=(r,e,s)=>(Lt(r,typeof e!="symbol"?e+"":e,s),s);import{serializeable as d,Behaviour as h,Rigidbody as T,BoxCollider as Bt,Text as L,MeshRenderer as tt,AudioSource as de,ParticleSystem as Ee,FrameEvent as st,serializable as l,EventList as b,TypeStore as c,RectTransform as Ft,Mathf as _,GameObject as y,OrbitControls as it,NeedleXRSession as ot,getTempVector as j,Camera as Vt,WebXR as Wt,setWorldPosition as ce,InstantiateOptions as zt,Renderer as q,InstancingUtil as Nt,LODGroup as Gt,Volume as Ht,getWorldPosition as Ce,getParam as Q,Gizmos as rt,setParamWithoutReload as Ut,setWorldQuaternion as Qe,getWorldQuaternion as Ke,Animator as nt,WebXRImageTracking as Xt,syncField as K,showBalloonMessage as E,RoomEvents as Re,delay as Y,Animation as Me,isDevEnvironment as he,SceneSwitcher as qt,Collider as me,LogType as Yt,WaitForSeconds as Qt,ClearFlags as Kt,RGBAColor as Jt,logHierarchy as Je,getTempQuaternion as at,AnimationCurve as Zt,AssetReference as kt,NeedleXRController as Ze,XRControllerFollow as es,delayForFrames as lt,ParticleSystemShapeType as Pe,isDestroyed as ct,instantiate as ts}from"./needle-engine-4e95fd72.js";import{V as P,a as z,P as ss,O as B,C as N,M as is,b as $e,c as os,d as Te,Q as X,S as rs,A as ns}from"./three.module-f5f097f2.js";import"./index-e4fe84b9.js";var as=Object.defineProperty,ls=Object.getOwnPropertyDescriptor,F=(r,e,s,i)=>{for(var t=i>1?void 0:i?ls(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&as(e,s,t),t},ne=(r=>(r[r.left=-1]="left",r[r.right=1]="right",r))(ne||{});class A extends h{constructor(){super(...arguments),this.speed=1,this._initPosition=new P(0,0,0),this._heightDir=0}get actualHeight(){return this.gameObject.transform.position.y}get ballPosition(){var e;return(e=v.instance)==null?void 0:e.gameObject.transform.position}get upString(){return this.isSecondPlayer?"ArrowUp":"w"}get downString(){return this.isSecondPlayer?"ArrowDown":"s"}get displacement(){return this.gameObject.position.x<0?1:-1}get colliderHeight(){var e;return((e=this.collider)==null?void 0:e.size.y)??0}get colliderCenter(){var e;return((e=this.collider)==null?void 0:e.body.bounds.center)??0}awake(){this._body=this.gameObject.getComponent(T)}start(){this.canMove=!0,this.gameObject.getWorldPosition(this._initPosition)}update(){var e;this.canMove&&(this.isPlayer?this.isPlayer&&(this.context.input.isKeyPressed(this.upString)?this._heightDir=1:this.context.input.isKeyPressed(this.downString)?this._heightDir=-1:this._heightDir=0):Math.abs(this.ballPosition.y-this.actualHeight)>this.aiDeathzone&&v.direction==this.displacement?this._heightDir=this.ballPosition.y>this.actualHeight?1:-1:this._heightDir=0,this.move(this._heightDir*this.speed*this.context.time.deltaTime),this.speedDebug.text=`Speed ${(e=this._body)==null?void 0:e.getVelocity().y.toFixed()}`)}move(e){this._body!=null&&this._body.setVelocity(0,e,0)}stop(){this.canMove=!1}resetPosition(){this.gameObject.worldPosition.set(this._initPosition.x,this._initPosition.y,this._initPosition.z),this.canMove=!0}}F([d()],A.prototype,"canMove",2);F([d()],A.prototype,"isPlayer",2);F([d()],A.prototype,"isSecondPlayer",2);F([d()],A.prototype,"aiDeathzone",2);F([d()],A.prototype,"speed",2);F([d(Bt)],A.prototype,"collider",2);F([d(L)],A.prototype,"speedDebug",2);F([d(L)],A.prototype,"displacementDebug",2);class ae{static get value(){return Math.random()}static range(e,s){return(s-e)*Math.random()+e}static rangeInt(e,s){return Math.floor(this.range(e,s))}}class ue extends h{}var cs=Object.defineProperty,hs=Object.getOwnPropertyDescriptor,S=(r,e,s,i)=>{for(var t=i>1?void 0:i?hs(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&cs(e,s,t),t};const le=class extends h{constructor(){super(...arguments),this._startposition=new P(0,0,0)}static get instance(){return le._instance}static get direction(){var r,e,s;return((r=this._instance)==null?void 0:r.body)==null?ne.right:((s=(e=this._instance)==null?void 0:e.body)==null?void 0:s.getVelocity().x)>0?ne.left:ne.right}awake(){le._instance==null&&(le._instance=this,this.gameObject.getWorldPosition(this._startposition),this.initialPush())}update(){var r,e;this.velocityDebug!=null&&(this.velocityDebug.text=`Speed ${(r=this.body)==null?void 0:r.getVelocity().x.toFixed(2)},  ${(e=this.body)==null?void 0:e.getVelocity().y.toFixed(2)}`)}stop(){this.body.setVelocity(0,0,0,!0),this.rend.enabled=!1,this.particles.play()}resetBall(){this.startCoroutine(this.internalReset(),st.Update)}*internalReset(){this.resetBallPosition(),this.rend.enabled=!0;for(let r=0;r<2;r+=this.context.time.deltaTime)yield;this.initialPush()}initialPush(){let r=new P(ae.value<.5?-1:1,0,0);r.y=ae.range(-this.maxInitAngle,this.maxInitAngle),console.log(`Init ${r.toArray()}`),this.body.setVelocity(r.x*this.moveSpeed,r.y,0,!0),this.particles.gameObject.rotation.set(0,0,r.x*(90*Math.PI/180))}resetBallPosition(){this.body.setWorldPosition(this._startposition.x,this._startposition.y,this._startposition.z);let r=ae.range(-this.maxStartY,this.maxStartY),e=new P(this._startX,r);this.gameObject.transform.worldPosition.set(e.x,e.y,e.z)}onCollisionEnter(r){var s;let e=r.gameObject.getComponent(ue);(s=this.audio)==null||s.play(),e!=null&&e.applyEffect(this,r)}setVelocity(r,e){this.body.setVelocity(e.x,e.y,e.z,!0),this.particles.gameObject.rotation.set(0,0,r*90*Math.PI/180)}};let v=le;S([d(tt)],v.prototype,"rend",2);S([d(T)],v.prototype,"body",2);S([d(de)],v.prototype,"audio",2);S([d(Ee)],v.prototype,"particles",2);S([d()],v.prototype,"particleAbs",2);S([d()],v.prototype,"maxInitAngle",2);S([d()],v.prototype,"maxCollisionAngle",2);S([d()],v.prototype,"moveSpeed",2);S([d()],v.prototype,"maxStartY",2);S([d()],v.prototype,"speedMultiplier",2);S([d(L)],v.prototype,"velocityDebug",2);S([d(L)],v.prototype,"lastRelative",2);class ps extends ue{awake(){this.bar??(this.bar=this.gameObject.getComponent(A))}applyEffect(e,s){let i=new P(0,0,0);for(let n=0;n<s.contacts.length;n++)i.add(s.contacts[n].point);i.divideScalar(s.contacts.length);let o=(i.y-this.bar.worldPosition.y)*2/this.bar.colliderHeight;this.velocity=e.body.getVelocity(),this.velocity.set(this.bar.displacement*e.moveSpeed,this.velocity.y+o,0),e.setVelocity(this.bar.displacement,this.velocity)}}var ds=Object.defineProperty,ms=Object.getOwnPropertyDescriptor,Ae=(r,e,s,i)=>{for(var t=i>1?void 0:i?ms(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ds(e,s,t),t};class J extends ue{applyEffect(e,s){var i;e.stop(),(i=this.onGoal)==null||i.invoke(this.playerIndex),this.startCoroutine(this.rotate(),st.Update)}*rotate(){var e;for(let s=0;s<2;s+=this.context.time.deltaTime)yield;(e=this.onReset)==null||e.invoke(),v.instance.resetBall()}}J._seconds=2.5;Ae([l()],J.prototype,"playerIndex",2);Ae([l(b)],J.prototype,"onGoal",2);Ae([l(b)],J.prototype,"onReset",2);let us=class extends h{start(){console.log("Hello World!")}};class fs extends ue{applyEffect(e,s){let i=e.body.getVelocity();e.body.setVelocity(i.x,-i.y,0,!0)}}c.add("Ball",v);c.add("BarEffector",ps);c.add("BarMovement",A);c.add("GoalEffector",J);c.add("Random",ae);c.add("test",us);c.add("WallEffector",fs);var gs=Object.defineProperty,ys=Object.getOwnPropertyDescriptor,ht=(r,e,s,i)=>{for(var t=i>1?void 0:i?ys(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&gs(e,s,t),t};class Ie extends h{constructor(){super(...arguments),this.safeArea=new z(0,0)}update(){var t,o;const e=this.context.domWidth/this.safeArea.x,s=this.context.domHeight/this.safeArea.y,i=_.clamp(Math.min(e,s),0,1);(o=(t=this.rectTransform)==null?void 0:t.shadowComponent)==null||o.scale.setScalar(i)}}ht([l(Ft)],Ie.prototype,"rectTransform",2);ht([l(z)],Ie.prototype,"safeArea",2);var bs=Object.defineProperty,vs=Object.getOwnPropertyDescriptor,Le=(r,e,s,i)=>{for(var t=i>1?void 0:i?vs(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&bs(e,s,t),t};class fe extends h{constructor(){super(...arguments),this.createMenuButton=!1,this.teleportVRPlayer=!1,this.ignoreYInVR=!1,this.menuButton=null}get orbitalCamera(){return this._orbitalCamera??(this._orbitalCamera=y.findObjectOfType(it)),this._orbitalCamera}awake(){this.createMenuButton&&this.addButton()}addButton(){var i;this.menuButton&&this.removeButton();const e=((i=this.gameObject.getComponentInChildren(L))==null?void 0:i.text)??this.gameObject.name,s=document.createElement("button");this.menuButton=s,s.innerText=e.replace("_"," "),s.setAttribute("priority","40"),s.addEventListener("click",()=>this.use()),this.context.menu.appendChild(s)}removeButton(){this.menuButton&&(this.menuButton.remove(),this.menuButton=null)}use(){var s,i;(s=this.orbitalCamera)==null||s.setCameraTargetPosition(this.worldPosition);const e=(i=ot.active)==null?void 0:i.rig;if(this.teleportVRPlayer&&this.context.isInVR&&e){const t=j(this.worldPosition);this.ignoreYInVR&&(t.y=e.gameObject.worldPosition.y),e.gameObject.worldPosition=t}}}Le([l()],fe.prototype,"createMenuButton",2);Le([l()],fe.prototype,"teleportVRPlayer",2);Le([l()],fe.prototype,"ignoreYInVR",2);class ws extends h{constructor(){super(...arguments),this.cam=null}onEnable(){this.cam=this.gameObject.getComponent(Vt),this.cam||(console.warn("CameraLayer requires a Camera component"),this.enabled=!1)}onAfterRender(){if(!this.cam)return;const e=this.scene.background;this.context.renderer.autoClearColor=!1,this.cam.cam instanceof ss&&this.context.updateAspect(this.cam.cam),this.scene.background=null,this.context.renderer.render(this.scene,this.cam.cam),this.scene.background=e}}var _s=Object.defineProperty,xs=Object.getOwnPropertyDescriptor,ge=(r,e,s,i)=>{for(var t=i>1?void 0:i?xs(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&_s(e,s,t),t};class Z extends h{constructor(){super(...arguments),this.strength=10,this.maxInstances=10,this._instances=[],this._index=-1,this._onPointerDown=e=>{e.button===0&&this.throwBall(e.space.worldPosition,e.space.worldForward)}}start(){this.prefab&&y.setActive(this.prefab,!1),this.webXR??(this.webXR=y.findObjectOfType(Wt))}onEnable(){this.context.input.addEventListener("pointerdown",this._onPointerDown)}onDisable(){this.context.input.removeEventListener("pointerdown",this._onPointerDown)}throwBall(e,s){var n,p;if(!this.prefab)return;if(this._instances.length<this.maxInstances){const f=new zt;f.position=e;const g=y.instantiate(this.prefab,f);if(!g)return;this._instances.push(g)}const i=++this._index,t=this._instances[i%this._instances.length];if(!t)return;ce(t,e),y.setActive(t,!0),(n=this.audioSource)==null||n.stop(),(p=this.audioSource)==null||p.play();const o=y.getComponent(t,T);o&&(s.multiplyScalar(this.strength),o.resetForcesAndTorques(),o.resetVelocities(),o==null||o.applyImpulse(s))}}ge([d(B)],Z.prototype,"prefab",2);ge([d(de)],Z.prototype,"audioSource",2);ge([d()],Z.prototype,"strength",2);ge([d()],Z.prototype,"maxInstances",2);var Os=Object.defineProperty,Ps=Object.getOwnPropertyDescriptor,pt=(r,e,s,i)=>{for(var t=i>1?void 0:i?Ps(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Os(e,s,t),t};class Be extends h{constructor(){super(...arguments),this.applyOnStart=!0,this.randomMetallicRoughness=!0}start(){{const e=this.gameObject.getComponent(q);if(!e)return;for(let s=0;s<e.sharedMaterials.length;s++)e.sharedMaterials[s]=e.sharedMaterials[s].clone()}this.applyOnStart&&this.applyRandomColor()}applyRandomColor(){const e=this.gameObject.getComponent(q);if(!e){console.warn("Can not change color: No renderer on "+this.name);return}for(let s=0;s<e.sharedMaterials.length;s++){const i=e.sharedMaterials[s];i.color=new N(Math.random(),Math.random(),Math.random()),this.randomMetallicRoughness&&i instanceof is&&(i.metalness=Math.random(),i.roughness=Math.random()*Math.random()),i.needsUpdate=!0,Nt.markDirty(this.gameObject)}}}pt([d()],Be.prototype,"applyOnStart",2);pt([d()],Be.prototype,"randomMetallicRoughness",2);class Cs extends h{constructor(){super(...arguments),this.renderer=null,this.collisionCount=0}start(){if(this.renderer=this.gameObject.getComponent(q),!!this.renderer){this._startColor||(this._startColor=[]);for(let e=0;e<this.renderer.sharedMaterials.length;e++)this.renderer.sharedMaterials[e]=this.renderer.sharedMaterials[e].clone(),this._startColor[e]=this.renderer.sharedMaterials[e].color.clone()}}onCollisionEnter(e){if(this.renderer){this.collisionCount+=1;for(let s=0;s<this.renderer.sharedMaterials.length;s++)this.renderer.sharedMaterials[s].color.setRGB(Math.random(),Math.random(),Math.random())}}onCollisionExit(e){if(!(!this.renderer||!this._startColor)&&(this.collisionCount-=1,this.collisionCount===0))for(let s=0;s<this.renderer.sharedMaterials.length;s++)this.renderer.sharedMaterials[s].color.copy(this._startColor[s])}}var js=Object.defineProperty,Ss=Object.getOwnPropertyDescriptor,Ds=(r,e,s,i)=>{for(var t=i>1?void 0:i?Ss(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&js(e,s,t),t};class dt extends h{update(){this.myMaterial&&(this.myMaterial._Speed*=1+this.context.time.deltaTime,this.myMaterial._Speed>1&&(this.myMaterial._Speed=5e-4),this.context.time.frame%30===0&&console.log(this.myMaterial._Speed))}}Ds([l($e)],dt.prototype,"myMaterial",2);var Es=Object.defineProperty,Rs=Object.getOwnPropertyDescriptor,mt=(r,e,s,i)=>{for(var t=i>1?void 0:i?Rs(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Es(e,s,t),t};class Fe extends h{constructor(){super(...arguments),this.tempVec1=new P,this.tempVec2=new P}update(){if(!this.lodGroup||!this.text)return;const e=this.context.mainCamera;e.getWorldPosition(this.tempVec1),this.gameObject.getWorldPosition(this.tempVec2);const s=this.tempVec1.distanceTo(this.tempVec2)/e.zoom,i=this.lodGroup._lodsHandler;let t=null;i==null||i.forEach(o=>{var g,O;const n=o.levels[o.getCurrentLevel()],p=o.levels.at(o.getCurrentLevel()+1);let f=null;if(n.object instanceof os){const m=n.object.geometry.attributes,R=Math.floor(((g=m.position)==null?void 0:g.count)||0);f=`Triangles: ${Math.floor((((O=m.index)==null?void 0:O.count)||R)/3)}, Vertices: ${R}`}n.object.name.replace(/_/g,""),n.object.name.includes("Cull")||(t="",f&&(t+=`${f}
`),p==null||p.hysteresis,t+=`${n.distance.toFixed(1)} / ${s.toFixed(1)}`,p&&(t+=` / ${(p.distance-p.distance*p.hysteresis).toFixed(1)}`))}),t||(t="culled"),this.text.text=t}}mt([l(Gt)],Fe.prototype,"lodGroup",2);mt([l(L)],Fe.prototype,"text",2);var Ms=Object.defineProperty,$s=Object.getOwnPropertyDescriptor,Ve=(r,e,s,i)=>{for(var t=i>1?void 0:i?$s(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Ms(e,s,t),t};class ye extends h{constructor(){super(...arguments),this.apertureMultiplier=2,this.focalLength=.001,this.focusDistanceCutoff=25,this.volume=null,this.dofEffect=void 0}onEnable(){var e,s,i;this.volume=y.findObjectOfType(Ht),this.dofEffect=(i=(s=(e=this.volume)==null?void 0:e.sharedProfile)==null?void 0:s.components)==null?void 0:i.find(t=>t.typeName==="DepthOfField"),this.orbit=y.findObjectOfType(it)}onBeforeRender(){var s;if(!((s=this.orbit)!=null&&s.controls))return;const e=this.orbit.controls.target.distanceTo(Ce(this.orbit.gameObject));if(this.dofEffect){this.dofEffect.focusDistance.value=e,this.dofEffect.focalLength.value=this.focalLength;let i=_.inverseLerp(0,this.focusDistanceCutoff,e);i=_.clamp01(i),this.dofEffect.aperture.value=_.lerp(this.apertureMultiplier,32,i);const t=this.focusDistanceCutoff;e>t&&this.dofEffect.active?this.dofEffect.active=!1:e<t&&!this.dofEffect.active&&(this.dofEffect.active=!0)}}}Ve([l()],ye.prototype,"apertureMultiplier",2);Ve([l()],ye.prototype,"focalLength",2);Ve([l()],ye.prototype,"focusDistanceCutoff",2);class Ts extends h{constructor(){super(...arguments),this._previousEnvironmentTexture=null}onEnable(){this._previousEnvironmentTexture=this.context.scene.environment,this.context.scene.environment=null}onDisable(){this.context.scene.environment=this._previousEnvironmentTexture}}var As=Object.defineProperty,Is=Object.getOwnPropertyDescriptor,Ls=(r,e,s,i)=>{for(var t=i>1?void 0:i?Is(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&As(e,s,t),t};const Bs=Q("sample_debugParticlesOnClick");class ut extends h{constructor(){super(...arguments),this.particleSystems=[]}update(){if(!this.context.isInVR&&this.context.input.getPointerClicked(0)){const e=this.context.physics.raycast();e.length>0&&this.spawnParticlesAt(e[0].point)}}onUpdateXR(e){e.xr.controllers.forEach(s=>{var i,t;if(((i=s.getButton("primary"))==null?void 0:i.isDown)===!0){const o=(t=this.context.physics.raycastFromRay(s.ray))==null?void 0:t.at(0);o&&this.spawnParticlesAt(o.point)}})}spawnParticlesAt(e){ce(this.gameObject,e),Bs&&rt.DrawWireSphere(e,.5,16711680,1);for(const s of this.particleSystems)s&&(y.setActive(s.gameObject,!0),s.play())}}Ls([d(Ee)],ut.prototype,"particleSystems",2);var Fs=Object.defineProperty,Vs=Object.getOwnPropertyDescriptor,Ws=(r,e,s,i)=>{for(var t=i>1?void 0:i?Vs(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Fs(e,s,t),t};class ft extends h{constructor(){super(...arguments),this.parameters=[]}awake(){var e=!1;this.parameters.forEach(s=>{Q(s)||(Ut(s,""),e=!0)}),e&&window.location.reload()}}Ws([l()],ft.prototype,"parameters",2);var zs=Object.defineProperty,Ns=Object.getOwnPropertyDescriptor,gt=(r,e,s,i)=>{for(var t=i>1?void 0:i?Ns(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&zs(e,s,t),t};class We extends h{constructor(){super(...arguments),this.htmlSelector="button.some-button",this.onClick=new b,this.onClicked=()=>{this.onClick.invoke()}}onEnable(){this.element=document.querySelector(this.htmlSelector),this.element?this.element.addEventListener("click",this.onClicked):console.warn(`Could not find element with selector "${this.htmlSelector}"`)}onDisable(){this.element&&this.element.removeEventListener("click",this.onClicked)}}gt([d()],We.prototype,"htmlSelector",2);gt([l(b)],We.prototype,"onClick",2);var Gs=Object.defineProperty,Hs=Object.getOwnPropertyDescriptor,yt=(r,e,s,i)=>{for(var t=i>1?void 0:i?Hs(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Gs(e,s,t),t};const bt=class extends h{onEnable(){var r;if(!(!this.methods||!this.names)){console.log("HTMLMenu.onEnable"),this.wrapper=document.createElement("ul"),this.wrapper.classList.add("needle-menu");for(let e=0;e<this.methods.length;e++){const s=this.methods[e];let i="Button";e<((r=this.names)==null?void 0:r.length)&&(i=this.names[e]);const t=document.createElement("li"),o=document.createElement("button");o.innerHTML=i,o.onclick=()=>{s.invoke()},t.appendChild(o),this.wrapper.appendChild(t)}this.styleElement=document.createElement("style"),this.styleElement.innerHTML=bt.style,document.head.appendChild(this.styleElement),this.context.domElement.appendChild(this.wrapper)}}onDisable(){this.wrapper&&(this.wrapper.remove(),this.wrapper=void 0),this.styleElement&&(this.styleElement.remove(),this.styleElement=void 0)}};let be=bt;be.style=`
        .needle-menu {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
            list-style-type: none;
            margin: 0;
            overflow: hidden;
            background-color: white;
            display: flex;
            padding: 5px;
            border-radius: 20px;
        }

        .needle-menu li button {
            padding: 5px;
            margin: 0 5px;
            background: none;
            outline: none;
            border: 0;
            cursor: pointer;
        }

        .needle-menu li button:hover {
            font-weight: bold;
        }
    `;yt([l(b)],be.prototype,"methods",2);yt([l()],be.prototype,"names",2);const ke=new P,Us=new X,et=new P;class Xs extends B{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(s){s.element instanceof Element&&s.element.parentNode!==null&&s.element.parentNode.removeChild(s.element)})})}copy(e,s){return super.copy(e,s),this.element=e.element.cloneNode(!0),this}}const $=new Te,qs=new Te;class Ys{constructor(e={}){const s=this;let i,t,o,n;const p={camera:{style:""},objects:new WeakMap},f=e.element!==void 0?e.element:document.createElement("div");f.style.overflow="hidden",this.domElement=f;const g=document.createElement("div");g.style.transformOrigin="0 0",g.style.pointerEvents="none",f.appendChild(g);const O=document.createElement("div");O.style.transformStyle="preserve-3d",g.appendChild(O),this.getSize=function(){return{width:i,height:t}},this.render=function(u,a){const C=a.projectionMatrix.elements[5]*n;a.view&&a.view.enabled?(g.style.transform=`translate( ${-a.view.offsetX*(i/a.view.width)}px, ${-a.view.offsetY*(t/a.view.height)}px )`,g.style.transform+=`scale( ${a.view.fullWidth/a.view.width}, ${a.view.fullHeight/a.view.height} )`):g.style.transform="",u.matrixWorldAutoUpdate===!0&&u.updateMatrixWorld(),a.parent===null&&a.matrixWorldAutoUpdate===!0&&a.updateMatrixWorld();let G,D;a.isOrthographicCamera&&(G=-(a.right+a.left)/2,D=(a.top+a.bottom)/2);const M=a.view&&a.view.enabled?a.view.height/a.view.fullHeight:1,H=a.isOrthographicCamera?`scale( ${M} )scale(`+C+")translate("+m(G)+"px,"+m(D)+"px)"+R(a.matrixWorldInverse):`scale( ${M} )translateZ(`+C+"px)"+R(a.matrixWorldInverse),U=(a.isPerspectiveCamera?"perspective("+C+"px) ":"")+H+"translate("+o+"px,"+n+"px)";p.camera.style!==U&&(O.style.transform=U,p.camera.style=U),re(u,u,a)},this.setSize=function(u,a){i=u,t=a,o=i/2,n=t/2,f.style.width=u+"px",f.style.height=a+"px",g.style.width=u+"px",g.style.height=a+"px",O.style.width=u+"px",O.style.height=a+"px"};function m(u){return Math.abs(u)<1e-10?0:u}function R(u){const a=u.elements;return"matrix3d("+m(a[0])+","+m(-a[1])+","+m(a[2])+","+m(a[3])+","+m(a[4])+","+m(-a[5])+","+m(a[6])+","+m(a[7])+","+m(a[8])+","+m(-a[9])+","+m(a[10])+","+m(a[11])+","+m(a[12])+","+m(-a[13])+","+m(a[14])+","+m(a[15])+")"}function W(u){const a=u.elements;return"translate(-50%,-50%)"+("matrix3d("+m(a[0])+","+m(a[1])+","+m(a[2])+","+m(a[3])+","+m(-a[4])+","+m(-a[5])+","+m(-a[6])+","+m(-a[7])+","+m(a[8])+","+m(a[9])+","+m(a[10])+","+m(a[11])+","+m(a[12])+","+m(a[13])+","+m(a[14])+","+m(a[15])+")")}function re(u,a,C,G){if(u.isCSS3DObject){const D=u.visible===!0&&u.layers.test(C.layers)===!0;if(u.element.style.display=D===!0?"":"none",D===!0){u.onBeforeRender(s,a,C);let M;u.isCSS3DSprite?($.copy(C.matrixWorldInverse),$.transpose(),u.rotation2D!==0&&$.multiply(qs.makeRotationZ(u.rotation2D)),u.matrixWorld.decompose(ke,Us,et),$.setPosition(ke),$.scale(et),$.elements[3]=0,$.elements[7]=0,$.elements[11]=0,$.elements[15]=1,M=W($)):M=W(u.matrixWorld);const H=u.element,Oe=p.objects.get(u);if(Oe===void 0||Oe.style!==M){H.style.transform=M;const U={style:M};p.objects.set(u,U)}H.parentNode!==O&&O.appendChild(H),u.onAfterRender(s,a,C)}}for(let D=0,M=u.children.length;D<M;D++)re(u.children[D],a,C)}}}var Qs=Object.defineProperty,Ks=Object.getOwnPropertyDescriptor,ve=(r,e,s,i)=>{for(var t=i>1?void 0:i?Ks(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Qs(e,s,t),t};class k extends h{constructor(){super(...arguments),this.url="https://www.youtube.com/embed/puWNRrG4MCg",this.pixelsPerUnit=500,this.borderRadius=50,this.animator=null,this.rotate90=new X().setFromAxisAngle(new P(0,1,0),Math.PI)}start(){const e=Q("url");e&&(this.url=e);const s=document.createElement("div");s.innerHTML='<iframe width="1000" height="1000" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; xr-spatial-tracking; xr" allowfullscreen></iframe>',s.style.zIndex="10000",s.style.position="absolute",s.style.pointerEvents="initial";const i=s.querySelector("iframe");i.addEventListener("load",()=>{setTimeout(()=>{var f;console.log("Automatically opening iframe"),(f=this.animator)==null||f.SetBool("Open",!0)},1e3)}),i.src=this.url;let t=1e3;const o=Math.round(this.gameObject.scale.x*this.pixelsPerUnit),n=Math.round(this.gameObject.scale.y*this.pixelsPerUnit);t=Math.max(o,n),i.width=o+"px",i.height=n+"px",s.style.position="absolute",this.borderRadius>0&&(s.style.borderRadius=this.borderRadius+"px"),s.style.pointerEvents="initial",document.body.append(s),this.cssRenderer=new Ys,this.cssRenderer.domElement.style.pointerEvents="none",this.cssRenderer.domElement.style.position="absolute",this.cssRenderer.domElement.style.top="0px",document.body.append(this.cssRenderer.domElement),this.cssScene=new rs;const p=new Xs(s);p.scale.setScalar(Math.max(this.gameObject.scale.x,this.gameObject.scale.y)/t),ce(p,Ce(this.gameObject)),Qe(p,Ke(this.gameObject)),p.quaternion.multiply(this.rotate90),this.cssScene.add(p),this.cssObj=p,this.context.post_render_callbacks.push(this.onPostRender.bind(this))}onPostRender(){if(!this.cssObj||!this.cssRenderer||!this.cssScene)return;ce(this.cssObj,Ce(this.gameObject)),Qe(this.cssObj,Ke(this.gameObject)),this.cssObj.quaternion.multiply(this.rotate90);const e=this.context.mainCamera,s=this.gameObject;var i=e.position.clone().sub(this.gameObject.position).normalize(),t=s.getWorldDirection(new P);const o=i.dot(t);this.cssObj.visible=o<.15;const n=this.cssRenderer.getSize();(n.width!==this.context.domWidth||n.height!==this.context.domHeight)&&this.cssRenderer.setSize(this.context.domWidth,this.context.domHeight),this.cssRenderer.render(this.cssScene,this.context.mainCamera)}}ve([d()],k.prototype,"url",2);ve([d()],k.prototype,"pixelsPerUnit",2);ve([d()],k.prototype,"borderRadius",2);ve([d(nt)],k.prototype,"animator",2);class Js extends h{constructor(){super(...arguments),this._ui=null}awake(){const e=y.findObjectsOfType(Xt),s=document.createElement("div");s.style.cssText=`
            position: absolute;
            top: 1em;
            left: 1em;
            line-height: 1.5em;
            display: block;
            width: 200px;
        `,this.context.domElement.appendChild(s),this._ui=s;const i=document.createElement("h2");i.style.cssText=`
            margin-bottom: .7em;
        `,i.innerText="Sample Images",s.appendChild(i);const t=document.createElement("p");t.innerHTML=`Download the image and print it or you can also open the image in your browser
        <br><strong>Then enter AR and scan it with your camera.</strong>
        <br>Visit our <a target="_blank" href="https://docs.needle.tools/image-tracking">ImageTracking documentation</a> for more information.
        `,t.style.userSelect="all",s.appendChild(t);for(const o of e)this.createDownloadImageUI(o,s)}update(){var e;this.context.isInAR?(e=this._ui)==null||e.remove():this._ui&&!this._ui.parentNode&&this.context.domElement.appendChild(this._ui)}createDownloadImageUI(e,s){if(e.trackedImages)for(const i of e.trackedImages){if(!i.image)continue;const t=document.createElement("a");t.href=i.image,s.appendChild(t);const o=document.createElement("img");o.src=i.image,o.style.cssText=`
                min-width: 180px;
                max-width: 220px;
                width: 15vw;
                height: auto;
                aspect-ratio: 1.3;
                object-fit: cover;
                background: rgba(0,0,0,0.5);
                border-radius: 10px;
                border: 2px solid rgba(255,255,255,1);
                box-shadow: 0 0 10px rgba(0,0,0,.2);
                margin-left: -.5em;
            `,t.appendChild(o)}}}var Zs=Object.defineProperty,ks=Object.getOwnPropertyDescriptor,we=(r,e,s,i)=>{for(var t=i>1?void 0:i?ks(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Zs(e,s,t),t};class je extends h{onColorChanged(){typeof this.color=="number"&&(this.color=new N(this.color)),this.setColorToMaterials()}onPointerClick(e){const s=new N(Math.random(),Math.random(),Math.random());this.color=s}onEnable(){this.setColorToMaterials()}setColorToMaterials(){var s;const e=this.gameObject.getComponent(q);if(e)for(let i=0;i<e.sharedMaterials.length;i++){const t=(s=e.sharedMaterials[i])==null?void 0:s.clone();e.sharedMaterials[i]=t,t&&"color"in t&&(t.color=this.color)}else console.warn("No renderer found",this.gameObject)}}we([K(je.prototype.onColorChanged),l(N)],je.prototype,"color",2);class Se extends h{constructor(){super(...arguments),this.myArray=[],this.updateArray=()=>{const e=new Date().toLocaleTimeString();console.log("> Update array",e),this.myArray.length>10&&(console.log("Clearing array because we have reached 10 entries"),this.myArray.length=0),this.myArray.push(e),this.myArray=this.myArray,E('<strong>> Sent</strong> "'+e+'", we now have '+this.myArray.length+" elements")}}awake(){E("Open this window in another browser tab/window to see the networking in action..."),this.context.connection.beginListen(Re.JoinedRoom,async()=>{console.log("Will append a new value every 10 seconds"),setInterval(this.updateArray,1e4),await Y(100),this.updateArray()})}onArrayChanged(){console.log("< Received array",this.myArray[this.myArray.length-1],this.myArray),E('<strong>< Received</strong> "'+this.myArray[this.myArray.length-1]+'", we now have '+this.myArray.length+" elements")}}we([K(Se.prototype.onArrayChanged)],Se.prototype,"myArray",2);class ei{constructor(){this.name="",this.age=0}}class pe extends h{constructor(){super(...arguments),this.myObject=new ei,this._mockAge=0,this.updateObject=()=>{this.myObject.name=this.context.connection.connectionId,this._mockAge+=1,this.myObject.age=this._mockAge,this.myObject=this.myObject,console.log("> Updated",this.myObject),E('<strong>> Sent</strong> "'+this.myObject.name+'" is '+this.myObject.age+" years old")}}awake(){E("Open this window in another browser tab/window to see the networking in action..."),this.context.connection.beginListen(Re.JoinedRoom,async()=>{await Y(1),this.updateObject()})}onObjectChanged(){console.log("< Received object",this.myObject),E('<strong>< Received</strong> "'+this.myObject.name+'" is '+this.myObject.age+" years old")}}we([K(pe.prototype.onObjectChanged)],pe.prototype,"myObject",2);we([K()],pe.prototype,"_mockAge",2);var ti=Object.defineProperty,si=Object.getOwnPropertyDescriptor,vt=(r,e,s,i)=>{for(var t=i>1?void 0:i?si(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ti(e,s,t),t};class ze extends h{constructor(){super(...arguments),this.clampFrameRate=!0,this._clampFrameRate=!1,this.maxFrameRate=72,this._maxFrameRate=-1024}update(){if(this._clampFrameRate!==this.clampFrameRate||this._maxFrameRate!==this.maxFrameRate){const e=this.clampFrameRate?this.maxFrameRate:void 0;this.context.targetFrameRate=e,this._clampFrameRate=this.clampFrameRate,this._maxFrameRate=this.maxFrameRate}}setTarget(e){this.maxFrameRate=e,this.clampFrameRate=!0}setClamping(e){this.clampFrameRate=e}}vt([l()],ze.prototype,"clampFrameRate",2);vt([l()],ze.prototype,"maxFrameRate",2);var ii=Object.defineProperty,oi=Object.getOwnPropertyDescriptor,V=(r,e,s,i)=>{for(var t=i>1?void 0:i?oi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ii(e,s,t),t};class ee extends h{constructor(){super(...arguments),this.logEvents=!1}onCollisionEnter(e){var s;this.logEvents&&console.log("ENTER",e),(s=this.onEnter)==null||s.invoke(e)}onCollisionStay(e){var s;this.logEvents&&console.log("STAY",e),(s=this.onStay)==null||s.invoke(e)}onCollisionExit(e){var s;this.logEvents&&console.log("EXIT",e),(s=this.onExit)==null||s.invoke(e)}}V([d(b)],ee.prototype,"onEnter",2);V([d(b)],ee.prototype,"onStay",2);V([d(b)],ee.prototype,"onExit",2);V([d()],ee.prototype,"logEvents",2);class te extends h{onTriggerEnter(e){var s,i;this.triggerObjects&&this.triggerObjects.length>0&&!((s=this.triggerObjects)!=null&&s.includes(e.gameObject))||(i=this.onEnter)==null||i.invoke()}onTriggerStay(e){var s,i;this.triggerObjects&&this.triggerObjects.length>0&&!((s=this.triggerObjects)!=null&&s.includes(e.gameObject))||(i=this.onStay)==null||i.invoke()}onTriggerExit(e){var s,i;this.triggerObjects&&this.triggerObjects.length>0&&!((s=this.triggerObjects)!=null&&s.includes(e.gameObject))||(i=this.onExit)==null||i.invoke()}}V([d(y)],te.prototype,"triggerObjects",2);V([d(b)],te.prototype,"onEnter",2);V([d(b)],te.prototype,"onStay",2);V([d(b)],te.prototype,"onExit",2);var ri=Object.defineProperty,ni=Object.getOwnPropertyDescriptor,ai=(r,e,s,i)=>{for(var t=i>1?void 0:i?ni(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ri(e,s,t),t};class wt extends h{constructor(){super(...arguments),this._lastTriggerTime=0}onTriggerEnter(e){this.context.time.time-this._lastTriggerTime<.3||(this._lastTriggerTime=this.context.time.time,this.animation&&this.animation.play(0,{loop:!1}))}onTriggerExit(){}}ai([d(Me)],wt.prototype,"animation",2);var li=Object.defineProperty,ci=Object.getOwnPropertyDescriptor,hi=(r,e,s,i)=>{for(var t=i>1?void 0:i?ci(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&li(e,s,t),t};class _t extends h{onTriggerEnter(){var e,s;(e=this.animation)!=null&&e.isPlaying||(s=this.animation)==null||s.play(0,{loop:!1})}}hi([d(Me)],_t.prototype,"animation",2);var pi=Object.defineProperty,di=Object.getOwnPropertyDescriptor,mi=(r,e,s,i)=>{for(var t=i>1?void 0:i?di(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&pi(e,s,t),t};class xt extends h{onCollisionEnter(){var e,s;(e=this.audioSource)==null||e.stop(),(s=this.audioSource)==null||s.play()}}mi([d(de)],xt.prototype,"audioSource",2);var ui=Object.defineProperty,fi=Object.getOwnPropertyDescriptor,Ot=(r,e,s,i)=>{for(var t=i>1?void 0:i?fi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ui(e,s,t),t};class Ne extends h{constructor(){super(...arguments),this.referenceSize=512,this.updateSize=()=>{if(this.content){if(this.referenceSize<=0)return console.error("ResponsiveContent: Base width must be greater than 0.");const e=this.context.domWidth/this.referenceSize;this.content.scale.set(e,e,e)}else he()&&console.warn("ResponsiveContent: No content object set.")}}onEnable(){window.addEventListener("resize",this.updateSize),this.updateSize()}onDisable(){window.removeEventListener("resize",this.updateSize)}}Ot([l(B)],Ne.prototype,"content",2);Ot([l()],Ne.prototype,"referenceSize",2);var gi=Object.defineProperty,yi=Object.getOwnPropertyDescriptor,Ge=(r,e,s,i)=>{for(var t=i>1?void 0:i?yi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&gi(e,s,t),t};class Pt extends h{async sceneOpened(){var e;(e=this.animator)==null||e.setBool("SceneOpen",!0),this._htmlElement=this._getHtmlElement(),this.context.domElement.appendChild(this._htmlElement)}async sceneClosing(){var e,s;await Y(1e3),(e=this.animator)==null||e.setBool("SceneOpen",!1),await Y(1e3),(s=this._htmlElement)==null||s.remove()}_getHtmlElement(){if(!this._htmlElement){this._htmlElement=document.createElement("div"),this._htmlElement.style.cssText=`
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                // backdrop-filter: blur(10px);
            `;const e=document.createElement("img");e.src="https://engine.needle.tools/branding/needle-logo.png",this._htmlElement.appendChild(e)}return this._htmlElement}}Ge([l(nt)],Pt.prototype,"animator",2);class He extends h{sceneOpened(){var e;return he()&&console.log("Scene opened",this.name),(e=this.opened)==null||e.invoke(),Promise.resolve()}sceneClosing(){var e;return he()&&console.log("Scene closing",this.name),(e=this.closing)==null||e.invoke(),Promise.resolve()}}Ge([l(b)],He.prototype,"opened",2);Ge([l(b)],He.prototype,"closing",2);class bi extends h{next(){var e;this.switcher??(this.switcher=this.get()),console.log(this.switcher),(e=this.switcher)==null||e.selectNext()}previous(){var e;this.switcher??(this.switcher=this.get()),(e=this.switcher)==null||e.selectPrev()}get(){return y.findObjectOfType(qt)}}var vi=Object.defineProperty,wi=Object.getOwnPropertyDescriptor,_i=(r,e,s,i)=>{for(var t=i>1?void 0:i?wi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&vi(e,s,t),t};class Ct extends h{constructor(){super(...arguments),this.text=""}start(){E(this.text)}}_i([l()],Ct.prototype,"text",2);var xi=Object.defineProperty,Oi=Object.getOwnPropertyDescriptor,Pi=(r,e,s,i)=>{for(var t=i>1?void 0:i?Oi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&xi(e,s,t),t};const Ci=Q("testleaderboard");class De extends h{constructor(){super(...arguments),this._ready=!1}get ready(){return this._ready}onEnable(){this.context.connection.beginListen(Re.JoinedRoom,async()=>{await Y(100),this.context.connection.tryGetState(this.guid)||(this.data={scores:[]}),this._ready=!0}),Ci?(console.log("Enabled test leaderboard, adding random scores"),setInterval(()=>{this.insertScore("Player",Math.floor(Math.random()*1e3))},2e3)):he()&&E("You can add ?testleaderboard to the url to test the leaderboard")}insertScore(e,s){if(!this._ready){console.warn("Cannot insert score, data not received yet");return}const i=10,t=this.data.scores;for(;t.length>=i;){this.sortScores();const o=t.pop();if(o.score>s){console.log(`Score ${s} is lower than ${o==null?void 0:o.score} (lowest score), ignoring`),t.push(o);return}}console.log("Inserting score",e,s),t.push({name:e,score:s}),this.sortScores(),this.data=this.data}sortScores(){this.data.scores.sort((e,s)=>s.score-e.score)}onDataChanged(e){if(console.warn("Data changed!",e,this.data.scores),this.data.scores.length>0){const s=this.data.scores[0];E("HIGHSCORE - "+s.name+": "+s.score)}this.dispatchEvent(new CustomEvent("changed",{detail:this.data}))}}Pi([K(De.prototype.onDataChanged)],De.prototype,"data",2);var ji=Object.defineProperty,Si=Object.getOwnPropertyDescriptor,Di=(r,e,s,i)=>{for(var t=i>1?void 0:i?Si(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ji(e,s,t),t};class jt extends h{start(){this.updateStartPosition()}updateStartPosition(){this.startPosition=this.gameObject.position.clone()}resetToStart(){if(!this.startPosition)return;const e=y.getComponent(this.gameObject,T);e==null||e.teleport(this.startPosition)}}class St extends jt{start(){super.start(),this.worldCollider||console.warn("Missing collider to reset",this)}onTriggerExit(e){e===this.worldCollider&&this.resetToStart()}}Di([d(me)],St.prototype,"worldCollider",2);var Ei=Object.defineProperty,Ri=Object.getOwnPropertyDescriptor,Mi=(r,e,s,i)=>{for(var t=i>1?void 0:i?Ri(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Ei(e,s,t),t};class Dt extends h{constructor(){super(...arguments),this.roomId="",this.playerCount=0}update(){const e=this.context.connection;let s=!1;e.currentRoomName&&e.currentRoomName!==this.roomId&&(this.roomId=e.currentRoomName,s=!0),e.usersInRoom().length!==this.playerCount&&(this.playerCount=e.usersInRoom().length,s=!0),s&&this.connectionLabel&&(this.connectionLabel.text=`Room: ${this.roomId}
Users: ${this.playerCount}
Your id: ${e.connectionId}`)}}Mi([l(L)],Dt.prototype,"connectionLabel",2);var $i=Object.defineProperty,Ti=Object.getOwnPropertyDescriptor,Ai=(r,e,s,i)=>{for(var t=i>1?void 0:i?Ti(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&$i(e,s,t),t};class Et extends h{constructor(){super(...arguments),this.interval=1e3,this.max=100,this.spawned=0}awake(){if(!this.object){console.warn("TimedSpawn: no object to spawn"),E("TimedSpawn: no object to spawn",Yt.Warn);return}y.setActive(this.object,!1),this.startCoroutine(this.spawn())}*spawn(){if(this.object)for(;this.spawned<this.max;){const e=y.instantiate(this.object);y.setActive(e,!0),this.spawned+=1,yield Qt(this.interval/1e3)}}}Ai([d(y)],Et.prototype,"object",2);class Ii extends h{async awake(){const e=document.createElement("video");e.style.cssText=`
            position: fixed;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
        `,this.context.domElement.shadowRoot.appendChild(e);const s=await navigator.mediaDevices.getUserMedia({video:!0});if(!s)return;e.srcObject=s,e.play();const i=this.context.mainCameraComponent;i&&(i.clearFlags=Kt.SolidColor,i.backgroundColor=new Jt(125,125,125,0))}}var Li=Object.defineProperty,Bi=Object.getOwnPropertyDescriptor,_e=(r,e,s,i)=>{for(var t=i>1?void 0:i?Bi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Li(e,s,t),t};class se extends h{constructor(){super(...arguments),this.interval=3,this.resetPosition=!0,this.resetRotation=!1,this.resetVelocity=!1}start(){const e=this.gameObject.position.clone(),s=this.gameObject.rotation.clone(),i=this.gameObject.getComponent(T),t=this.context.time.frame;setInterval(()=>{this.resetPosition&&this.gameObject.position.copy(e),this.resetRotation&&this.gameObject.rotation.copy(s),i&&this.resetVelocity&&this.context.time.frame!==t&&i.resetVelocities()},this.interval*1e3)}}_e([l()],se.prototype,"interval",2);_e([l()],se.prototype,"resetPosition",2);_e([l()],se.prototype,"resetRotation",2);_e([l()],se.prototype,"resetVelocity",2);class Fi extends h{constructor(){super(...arguments),this.toggleRendererOnly=!1}start(){setInterval(()=>{if(E('This is a sample for showing how to <a href="https://engine.needle.tools/docs/scripting.html#component-architecture" target="_blank">toggle visibility of a GameObject</a>'),this.toggleRendererOnly){const e=this.gameObject.getComponent(q);e&&(e.enabled=!e.enabled)}else this.gameObject.visible=!this.gameObject.visible},1e3)}}var Vi=Object.defineProperty,Wi=Object.getOwnPropertyDescriptor,zi=(r,e,s,i)=>{for(var t=i>1?void 0:i?Wi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Vi(e,s,t),t};class Rt extends h{awake(){this.material&&(this.material.wireframe=!0)}}zi([l($e)],Rt.prototype,"material",2);var Ni=Object.defineProperty,Gi=Object.getOwnPropertyDescriptor,Mt=(r,e,s,i)=>{for(var t=i>1?void 0:i?Gi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Ni(e,s,t),t};class Ue extends h{constructor(){super(...arguments),this.onSessionStart=new b,this.onSessionEnd=new b}onEnterXR(e){this.onWebXRStarted()}onExitXR(e){this.onWebXREnded()}onWebXRStarted(){Je(this.context.scene,!1),this.onSessionStart.invoke()}onWebXREnded(){Je(this.context.scene,!1),this.onSessionEnd.invoke()}}Mt([l(b)],Ue.prototype,"onSessionStart",2);Mt([l(b)],Ue.prototype,"onSessionEnd",2);class $t extends h{constructor(){super(...arguments),this.destroyTarget=!1,this._startTime=0}awake(){if(this._rigidbody=this.gameObject.getComponentInParent(T)||void 0,this._rigidbody){const e=this.gameObject.getComponentsInChildren(me);for(const s of e){const i=y.addComponent(s.gameObject,Hi);i.rigidBody=this._rigidbody,i.arrow=this,i.destroyTarget=this.destroyTarget}}this._startTime=this.context.time.time}onBeforeRender(){if(this.context.time.time-this._startTime>5){this.gameObject.destroy();return}if(this._rigidbody){const e=this._rigidbody.getVelocity();if(e.lengthSq()>0){const s=j().set(e.x,e.y,e.z).normalize(),i=at();i.setFromUnitVectors(j(0,0,1),s),this.gameObject.quaternion.copy(i)}}}}class Hi extends h{constructor(){super(...arguments),this.destroyTarget=!1}onCollisionEnter(e){if(this.arrow)if(this.destroyTarget)e.gameObject.destroy(),this.arrow.gameObject.destroy();else{e.gameObject.attach(this.arrow.gameObject),e.rigidBody instanceof T&&e.rigidBody.applyImpulse(e.gameObject.position.clone().multiply(this.rigidBody.getVelocity()),!0);const s=this.rigidBody.gameObject.getComponentsInChildren(me);for(const i of s)i.destroy();this.rigidBody.destroy(),this.arrow.destroy()}}}var Ui=Object.defineProperty,Xi=Object.getOwnPropertyDescriptor,x=(r,e,s,i)=>{for(var t=i>1?void 0:i?Xi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Ui(e,s,t),t};const qi=Q("debugarrow");class w extends h{constructor(){super(...arguments),this.power=1.5,this.drawMaxPhysicalDistance=.47269,this.drawMinPhysicalDistance=.1132593,this.desktopIdleDrawAmount=.25,this.interactionPixelOrigin=new z(.5,.65),this.interactionPixelTreshold=85,this.drawMaxPixelDistance=100,this._isAiming=!1,this._aimingPointerStartPos=new z(0,0),this._bowController=void 0,this._stringController=void 0,this.onDown=e=>{var s;if(e.origin instanceof Ze){if(e.button===0){this._isAiming=!0,this._bowController===void 0?this._bowController=e.origin.index:this._stringController===void 0&&(this._stringController=e.origin.index);const i=(s=this.bowObject)==null?void 0:s.getComponentInParent(es);i&&(i.side=this._bowController)}}else e.button===0&&(this.getPointerDinstanceTo(this._aimingPointerStartPos,e.pointerId),this._isAiming=!0,this._aimingPointerId=e.pointerId)},this.onRelease=e=>{var s;if(e.button===0&&this._isAiming){if(this._isAiming=!1,this._aimingPointerId=void 0,e.origin instanceof Ze){const i=e.origin;if(i.index===this._stringController&&this._bowController!==void 0){const t=(s=ot.active)==null?void 0:s.getController(this._bowController);if(i&&t){const o=i.gripWorldPosition;if(o){const n=t.gripWorldPosition.clone().sub(o);let p=t.object.worldPosition.distanceTo(i.object.worldPosition);p-=this.drawMinPhysicalDistance;const f=_.clamp01(p/this.drawMaxPhysicalDistance);n.normalize().multiplyScalar(f*this.power),this.shoot(o,n),qi&&rt.DrawArrow(o,n.clone().add(o),16776960,1)}}}i.index===this._bowController&&(this._bowController=void 0),i.index===this._stringController&&(this._stringController=void 0)}else if(this.arrowSpawnSpot){const i=this.arrowSpawnSpot.getWorldPosition(j()),t=this.gameObject.getWorldDirection(j()),o=this.getPointerDinstanceTo(this._aimingPointerStartPos,e.pointerId),n=_.clamp01(o/this.drawMaxPixelDistance)*this.power;t.multiplyScalar(n),o>this.interactionPixelTreshold&&this.shoot(i,t)}}},this.shotStamp=Number.MIN_SAFE_INTEGER,this.fakeArrowRespawnDuration=.3,this._initRot=new X,this._tempLookMatrix=new Te,this._tempLookRot=new X,this._rotate90=new X().setFromAxisAngle(new P(0,0,1),Math.PI/2),this.tempDir=new z,this.tempUpRef=new z}awake(){var e;(e=this.arrowPrefab)!=null&&e.asset&&(this.arrowPrefab.asset.visible=!1),this.bowObject&&this._initRot.copy(this.bowObject.quaternion),this.nonMountedParent=this.gameObject.parent,this.mount()}onEnable(){var e;(e=this.arrowPrefab)==null||e.loadAssetAsync(),this._isAiming=!1,this.context.input.addEventListener("pointerdown",this.onDown),this.context.input.addEventListener("pointerup",this.onRelease),this.setupPreDraw()}onDisable(){this._isAiming=!1,this.context.input.removeEventListener("pointerdown",this.onDown),this.context.input.removeEventListener("pointerup",this.onRelease)}getPointerDinstanceTo(e,s){const i=this.context.input.getPointerPosition(s);return e.distanceTo(i)}async setupPreDraw(){var s,i;if(!this.arrowPrefab||!this.arrowSpawnSpot||this.fakeArrow)return;const e=await this.arrowPrefab.instantiate({parent:this.arrowSpawnSpot});e&&(e.visible=!0,e.worldScale=j(1,1,1),this.fakeArrow=e,(s=e.getComponent($t))==null||s.destroy(),(i=e.getComponent(T))==null||i.destroy(),e.getComponentsInChildren(me).forEach(t=>t.destroy()))}async shoot(e,s){var g,O;if(!this.arrowPrefab)return;this.shotStamp=this.context.time.time;const i=e.clone(),t=i.clone().add(s),o=Math.pow(s.length()+.5,2),n=s.clone().normalize(),p=await this.arrowPrefab.instantiate({parent:this.context.scene});if(!p)return;p.worldPosition=i,p.lookAt(t),p.visible=!0;const f=p.getComponent(T);f&&(f.isKinematic=!1,f.autoMass=!1,f.mass=.05,(g=this.sound)==null||g.stop(),(O=this.sound)==null||O.play(),await lt(1),f.applyImpulse(n.multiplyScalar(o),!0))}mount(){this.cameraParent&&(this.gameObject.parent=this.cameraParent,this.gameObject.position.set(0,0,0),this.gameObject.quaternion.set(0,0,0,1))}unmount(){this.gameObject.parent=this.nonMountedParent}get _hasControllers(){var e;return(((e=this.context.xr)==null?void 0:e.controllers.length)??0)>0}onEnterXR(e){(e.xr.isVR||e.xr.isPassThrough)&&this.unmount()}onLeaveXR(e){this.mount()}onBeforeRender(){if(!this.animationComponent||!this.bowObject)return;if(!this._mixer){this._mixer=new ns(this.bowObject);const o=this.animationComponent.animations.at(0);o&&(this._animation=this._mixer.clipAction(o))}const e=.1;let s=0;if(this._hasControllers){if(!this._isAiming)s=0;else if(this.context.xr&&this.context.xr.controllers.length>1&&this._bowController!==void 0&&this._stringController!==void 0){const o=this.context.xr.controllers[this._stringController],n=this.context.xr.controllers[this._bowController];if(!o||!n)return;let p=j(0,1,0);!n.hand&&n.targetRayMode==="tracked-pointer"&&p.applyQuaternion(this._rotate90),p.applyQuaternion(n.gripWorldQuaternion).normalize(),this._tempLookMatrix.lookAt(o.gripWorldPosition,n.gripWorldPosition,p),this._tempLookRot.setFromRotationMatrix(this._tempLookMatrix),this.bowObject.worldQuaternion=this._tempLookRot;let f=o.object.worldPosition.distanceTo(n.object.worldPosition);f-=this.drawMinPhysicalDistance,s=_.clamp01(f/this.drawMaxPhysicalDistance)}}else{const o=this.interactionPixelOrigin;if(this._aimingPointerStartPos.set(this.context.domWidth*o.x,this.context.domHeight*o.y),!this._isAiming)s=this.desktopIdleDrawAmount;else{const n=this.context.input;if(this._aimingPointerId!=null){const p=this._aimingPointerStartPos,f=n.getPointerPosition(this._aimingPointerId),g=this.tempDir.copy(f).sub(p),m=g.length(),R=j();R.x=g.x,R.z=g.y,R.normalize();const W=this.gameObject.getWorldDirection(j());W.y=0,W.normalize();const re=R.dot(W),u=m>this.interactionPixelTreshold;(re>0||u)&&(s=_.clamp01(m/this.drawMaxPixelDistance)),this.tempUpRef.set(1,0);const C=this.tempUpRef.dot(g)>0?-1:1;this.tempUpRef.set(0,1);const G=this.tempUpRef.angleTo(g)*C;if(u){const D=at().setFromAxisAngle(j().set(1,0,0),G);this.gameObject.quaternion.slerp(D,this.context.time.deltaTime/.05)}}}}this.drawProgression&&(s=this.drawProgression.evaluate(s)),this._animation.timeScale=0;const i=_.lerp(this._animation.time,s,this.context.time.deltaTime/e),t=this._animation.time;if(this._animation.time=i,Math.abs(i-t)>Number.EPSILON&&(this._animation.setEffectiveWeight(1),this._animation.play()),this._mixer.update(this.context.time.deltaTime),this.fakeArrow){let o=(this.context.time.time-this.shotStamp)/this.fakeArrowRespawnDuration;o=this.easeInOutSine(_.clamp01(o)),this.fakeArrow.worldScale=j(1,1,1).multiplyScalar(o)}}easeInOutSine(e){return _.clamp01(-.5*(Math.cos(Math.PI*e)-1))}}x([l()],w.prototype,"power",2);x([l()],w.prototype,"drawMaxPhysicalDistance",2);x([l()],w.prototype,"drawMinPhysicalDistance",2);x([l(Zt)],w.prototype,"drawProgression",2);x([l(B)],w.prototype,"cameraParent",2);x([l()],w.prototype,"desktopIdleDrawAmount",2);x([l(z)],w.prototype,"interactionPixelOrigin",2);x([l()],w.prototype,"interactionPixelTreshold",2);x([l()],w.prototype,"drawMaxPixelDistance",2);x([l(B)],w.prototype,"bowObject",2);x([l(Me)],w.prototype,"animationComponent",2);x([l(kt)],w.prototype,"arrowPrefab",2);x([l(B)],w.prototype,"arrowSpawnSpot",2);x([l(de)],w.prototype,"sound",2);x([l()],w.prototype,"fakeArrowRespawnDuration",2);var Yi=Object.defineProperty,Qi=Object.getOwnPropertyDescriptor,Ki=(r,e,s,i)=>{for(var t=i>1?void 0:i?Qi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Yi(e,s,t),t};class Tt extends h{start(){this._meshRenderer=this.gameObject.getComponentInChildren(tt)}onDestroy(){if(this.particleSystem){if(this.particleSystem.shape.shapeType===Pe.MeshRenderer&&this._meshRenderer&&!ct(this._meshRenderer.gameObject)){this.particleSystem.shape.shapeType=Pe.MeshRenderer,this.particleSystem.shape.setMesh(this._meshRenderer),this.particleSystem.play();return}this.particleSystem.shape.shapeType=Pe.Sphere,this.particleSystem.worldPosition=this.gameObject.worldPosition,this.particleSystem.play()}}}Ki([l(Ee)],Tt.prototype,"particleSystem",2);var Ji=Object.defineProperty,Zi=Object.getOwnPropertyDescriptor,ki=(r,e,s,i)=>{for(var t=i>1?void 0:i?Zi(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&Ji(e,s,t),t};class At extends h{constructor(){super(...arguments),this._instances=new Array}awake(){var e,s;if(!((e=this.prefabs)!=null&&e.length)||((s=this.prefabs)==null?void 0:s.length)===0){console.warn("BowTargetSpawner start: no prefab set"),this.enabled=!1;return}this.prefabs.forEach(i=>i.visible=!1)}update(){var s;if(!((s=this.prefabs)!=null&&s.length))return;const e=j();for(let i=this._instances.length-1;i>=0;i--){const t=this._instances[i];ct(t.instance)?this._instances.splice(i,1):(e.setScalar(t.scale),t.instance.scale.lerp(e,this.context.time.deltaTime))}if(this.context.time.frame%20===0&&Math.random()>.5){const i=this.worldPosition;i.x+=Math.random()*12-6,i.y+=Math.random()*3,i.z+=Math.random()*6;const t=Math.random()*3+.5,o=this.prefabs[Math.floor(Math.random()*this.prefabs.length)],n=ts(o,{parent:this.scene,position:i.clone(),scale:new P(.01,.01,.01),keepWorldPosition:!0});n.visible=!0,this._instances.push({instance:n,scale:t}),setTimeout(()=>{n.destroy()},7e3),lt(1).then(()=>{const p=n.getComponentInChildren(T);p&&(p.gravityScale=.2+Math.random()*.3,p.mass=2,p.autoMass=!1),p==null||p.setAngularVelocity(_.random(-2,2),_.random(-2,2),_.random(-2,2)),p==null||p.applyImpulse({x:0,y:5+Math.random()*12,z:0})})}}}ki([l(B)],At.prototype,"prefabs",2);var eo=Object.defineProperty,to=Object.getOwnPropertyDescriptor,so=(r,e,s,i)=>{for(var t=i>1?void 0:i?to(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&eo(e,s,t),t};class Xe extends h{constructor(){super(...arguments),this.displayName=""}}so([l()],Xe.prototype,"displayName",2);var io=Object.defineProperty,oo=Object.getOwnPropertyDescriptor,qe=(r,e,s,i)=>{for(var t=i>1?void 0:i?oo(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&io(e,s,t),t};class xe extends h{constructor(){super(...arguments),this.objects=[],this.hideContentOnStart=!0,this.index=-1}awake(){this.hideContentOnStart||(this.index=0),this.apply()}next(){this.index++,this.index>=this.objects.length&&(this.index=0),this.apply()}previous(){this.index--,this.index<0&&(this.index=this.objects.length-1),this.apply()}apply(){for(let e=0;e<this.objects.length;e++)this.objects[e].visible=e===this.index;if(this.lable){const e=this.objects[this.index];if(e){const s=y.getComponent(e,Xe);this.lable.text=(s==null?void 0:s.displayName)??e.name}}}select(e){this.index=e,this.index=_.clamp(this.index,0,this.objects.length-1),this.apply()}}qe([l(B)],xe.prototype,"objects",2);qe([l()],xe.prototype,"hideContentOnStart",2);qe([l(L)],xe.prototype,"lable",2);c.add("AspectRatioFitterUI",Ie);c.add("CameraGoal",fe);c.add("CameraLayer",ws);c.add("Cannon",Z);c.add("RandomColor",Be);c.add("ChangeColorOnCollision",Cs);c.add("IncreaseShaderSpeedOverTime",dt);c.add("DebugLOD",Fe);c.add("DepthOfFieldController",ye);c.add("DisableEnvironmentLight",Ts);c.add("EmitParticlesOnClick",ut);c.add("EnforceParameters",ft);c.add("HTMLButtonClick",We);c.add("HTMLMenu",be);c.add("IFrameContent",k);c.add("ImageTrackingDownloadUI",Js);c.add("Networking_ClickToChangeColor",je);c.add("Networking_StringArray",Se);c.add("Networking_Object",pe);c.add("PerformanceSettings",ze);c.add("PhysicsCollision",ee);c.add("PhysicsTrigger",te);c.add("PlayAnimationOnCollision",wt);c.add("PlayAnimationOnTrigger",_t);c.add("PlayAudioOnCollision",xt);c.add("ResponsiveContent",Ne);c.add("LoadingSceneRoot",Pt);c.add("SceneLoadingEvents",He);c.add("SceneSwitcherControls",bi);c.add("ShowBalloonMessage",Ct);c.add("SimpleLeaderboard",De);c.add("StartPosition",jt);c.add("AutoReset",St);c.add("SyncedRoomUI",Dt);c.add("TimedSpawn",Et);c.add("VideoBackground",Ii);c.add("ResetPositionOnInterval",se);c.add("ToggleVisibility",Fi);c.add("WireframeMaterial",Rt);c.add("XRLifecycleEvents",Ue);c.add("Arrow",$t);c.add("ArrowShooting",w);c.add("BowArrowTarget",Tt);c.add("BowTargetSpawner",At);c.add("VariantInfo",Xe);c.add("VariantSwitcher",xe);var ro=Object.defineProperty,no=Object.getOwnPropertyDescriptor,ie=(r,e,s,i)=>{for(var t=i>1?void 0:i?no(e,s):e,o=r.length-1,n;o>=0;o--)(n=r[o])&&(t=(i?n(e,s,t):n(t))||t);return i&&t&&ro(e,s,t),t};class oe{constructor(){I(this,"_SkyColor");I(this,"_EquatorColor");I(this,"_GroundColor")}}ie([l(N)],oe.prototype,"_SkyColor",2);ie([l(N)],oe.prototype,"_EquatorColor",2);ie([l(N)],oe.prototype,"_GroundColor",2);class Ye extends h{constructor(){super(...arguments);I(this,"skybox");I(this,"gradients");I(this,"currentGradient");I(this,"nextGradient");I(this,"_switcher")}changeGradient(){}}ie([l($e)],Ye.prototype,"skybox",2);ie([l(oe)],Ye.prototype,"gradients",2);c.add("GradientFaderSceneSwitcher",Ye);c.add("SceneGradient",oe);
